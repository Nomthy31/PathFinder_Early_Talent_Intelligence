{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from '../lib/constants';\nimport { isStorageError } from '../lib/errors';\nimport { get, post, remove } from '../lib/fetch';\nimport { resolveFetch } from '../lib/helpers';\n/**\r\n * API class for managing Analytics Buckets using Iceberg tables\r\n * Provides methods for creating, listing, and deleting analytics buckets\r\n */\nexport default class StorageAnalyticsApi {\n  /**\r\n   * Creates a new StorageAnalyticsApi instance\r\n   * @param url - The base URL for the storage API\r\n   * @param headers - HTTP headers to include in requests\r\n   * @param fetch - Optional custom fetch implementation\r\n   */\n  constructor(url, headers = {}, fetch) {\n    this.shouldThrowOnError = false;\n    this.url = url.replace(/\\/$/, '');\n    this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n    this.fetch = resolveFetch(fetch);\n  }\n  /**\r\n   * Enable throwing errors instead of returning them in the response\r\n   * When enabled, failed operations will throw instead of returning { data: null, error }\r\n   *\r\n   * @returns This instance for method chaining\r\n   */\n  throwOnError() {\n    this.shouldThrowOnError = true;\n    return this;\n  }\n  /**\r\n   * Creates a new analytics bucket using Iceberg tables\r\n   * Analytics buckets are optimized for analytical queries and data processing\r\n   *\r\n   * @param name A unique name for the bucket you are creating\r\n   * @returns Promise with newly created bucket name or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await storage.analytics.createBucket('analytics-data')\r\n   * if (error) {\r\n   *   console.error('Failed to create analytics bucket:', error.message)\r\n   * } else {\r\n   *   console.log('Created bucket:', data.name)\r\n   * }\r\n   * ```\r\n   */\n  createBucket(name) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield post(this.fetch, `${this.url}/bucket`, {\n          name\n        }, {\n          headers: this.headers\n        });\n        return {\n          data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Retrieves the details of all Analytics Storage buckets within an existing project\r\n   * Only returns buckets of type 'ANALYTICS'\r\n   *\r\n   * @param options Query parameters for listing buckets\r\n   * @param options.limit Maximum number of buckets to return\r\n   * @param options.offset Number of buckets to skip\r\n   * @param options.sortColumn Column to sort by ('id', 'name', 'created_at', 'updated_at')\r\n   * @param options.sortOrder Sort order ('asc' or 'desc')\r\n   * @param options.search Search term to filter bucket names\r\n   * @returns Promise with list of analytics buckets or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await storage.analytics.listBuckets({\r\n   *   limit: 10,\r\n   *   offset: 0,\r\n   *   sortColumn: 'created_at',\r\n   *   sortOrder: 'desc',\r\n   *   search: 'analytics'\r\n   * })\r\n   * if (data) {\r\n   *   console.log('Found analytics buckets:', data.length)\r\n   *   data.forEach(bucket => console.log(`- ${bucket.name}`))\r\n   * }\r\n   * ```\r\n   */\n  listBuckets(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        // Build query string from options\n        const queryParams = new URLSearchParams();\n        if ((options === null || options === void 0 ? void 0 : options.limit) !== undefined) queryParams.set('limit', options.limit.toString());\n        if ((options === null || options === void 0 ? void 0 : options.offset) !== undefined) queryParams.set('offset', options.offset.toString());\n        if (options === null || options === void 0 ? void 0 : options.sortColumn) queryParams.set('sortColumn', options.sortColumn);\n        if (options === null || options === void 0 ? void 0 : options.sortOrder) queryParams.set('sortOrder', options.sortOrder);\n        if (options === null || options === void 0 ? void 0 : options.search) queryParams.set('search', options.search);\n        const queryString = queryParams.toString();\n        const url = queryString ? `${this.url}/bucket?${queryString}` : `${this.url}/bucket`;\n        const data = yield get(this.fetch, url, {\n          headers: this.headers\n        });\n        // Filter to only return analytics buckets\n        const analyticsBuckets = Array.isArray(data) ? data.filter(bucket => bucket.type === 'ANALYTICS') : [];\n        return {\n          data: analyticsBuckets,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Deletes an existing analytics bucket\r\n   * A bucket can't be deleted with existing objects inside it\r\n   * You must first empty the bucket before deletion\r\n   *\r\n   * @param bucketId The unique identifier of the bucket you would like to delete\r\n   * @returns Promise with success message or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await analyticsApi.deleteBucket('old-analytics-bucket')\r\n   * if (error) {\r\n   *   console.error('Failed to delete bucket:', error.message)\r\n   * } else {\r\n   *   console.log('Bucket deleted successfully:', data.message)\r\n   * }\r\n   * ```\r\n   */\n  deleteBucket(bucketId) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield remove(this.fetch, `${this.url}/bucket/${bucketId}`, {}, {\n          headers: this.headers\n        });\n        return {\n          data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n}","map":{"version":3,"names":["DEFAULT_HEADERS","isStorageError","get","post","remove","resolveFetch","StorageAnalyticsApi","constructor","url","headers","fetch","shouldThrowOnError","replace","Object","assign","throwOnError","createBucket","name","data","error","listBuckets","options","queryParams","URLSearchParams","limit","undefined","set","toString","offset","sortColumn","sortOrder","search","queryString","analyticsBuckets","Array","isArray","filter","bucket","type","deleteBucket","bucketId"],"sources":["C:\\Users\\koketso1\\Desktop\\hubHack\\PathFinder_Early_Talent_Intelligence\\Pathfinder\\node_modules\\@supabase\\storage-js\\src\\packages\\StorageAnalyticsApi.ts"],"sourcesContent":["import { DEFAULT_HEADERS } from '../lib/constants'\r\nimport { isStorageError, StorageError } from '../lib/errors'\r\nimport { Fetch, get, post, remove } from '../lib/fetch'\r\nimport { resolveFetch } from '../lib/helpers'\r\nimport { AnalyticBucket, Bucket } from '../lib/types'\r\n\r\n/**\r\n * API class for managing Analytics Buckets using Iceberg tables\r\n * Provides methods for creating, listing, and deleting analytics buckets\r\n */\r\nexport default class StorageAnalyticsApi {\r\n  protected url: string\r\n  protected headers: { [key: string]: string }\r\n  protected fetch: Fetch\r\n  protected shouldThrowOnError = false\r\n\r\n  /**\r\n   * Creates a new StorageAnalyticsApi instance\r\n   * @param url - The base URL for the storage API\r\n   * @param headers - HTTP headers to include in requests\r\n   * @param fetch - Optional custom fetch implementation\r\n   */\r\n  constructor(url: string, headers: { [key: string]: string } = {}, fetch?: Fetch) {\r\n    this.url = url.replace(/\\/$/, '')\r\n    this.headers = { ...DEFAULT_HEADERS, ...headers }\r\n    this.fetch = resolveFetch(fetch)\r\n  }\r\n\r\n  /**\r\n   * Enable throwing errors instead of returning them in the response\r\n   * When enabled, failed operations will throw instead of returning { data: null, error }\r\n   *\r\n   * @returns This instance for method chaining\r\n   */\r\n  public throwOnError(): this {\r\n    this.shouldThrowOnError = true\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * Creates a new analytics bucket using Iceberg tables\r\n   * Analytics buckets are optimized for analytical queries and data processing\r\n   *\r\n   * @param name A unique name for the bucket you are creating\r\n   * @returns Promise with newly created bucket name or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await storage.analytics.createBucket('analytics-data')\r\n   * if (error) {\r\n   *   console.error('Failed to create analytics bucket:', error.message)\r\n   * } else {\r\n   *   console.log('Created bucket:', data.name)\r\n   * }\r\n   * ```\r\n   */\r\n  async createBucket(name: string): Promise<\r\n    | {\r\n        data: AnalyticBucket\r\n        error: null\r\n      }\r\n    | {\r\n        data: null\r\n        error: StorageError\r\n      }\r\n  > {\r\n    try {\r\n      const data = await post(this.fetch, `${this.url}/bucket`, { name }, { headers: this.headers })\r\n      return { data, error: null }\r\n    } catch (error) {\r\n      if (this.shouldThrowOnError) {\r\n        throw error\r\n      }\r\n      if (isStorageError(error)) {\r\n        return { data: null, error }\r\n      }\r\n\r\n      throw error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieves the details of all Analytics Storage buckets within an existing project\r\n   * Only returns buckets of type 'ANALYTICS'\r\n   *\r\n   * @param options Query parameters for listing buckets\r\n   * @param options.limit Maximum number of buckets to return\r\n   * @param options.offset Number of buckets to skip\r\n   * @param options.sortColumn Column to sort by ('id', 'name', 'created_at', 'updated_at')\r\n   * @param options.sortOrder Sort order ('asc' or 'desc')\r\n   * @param options.search Search term to filter bucket names\r\n   * @returns Promise with list of analytics buckets or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await storage.analytics.listBuckets({\r\n   *   limit: 10,\r\n   *   offset: 0,\r\n   *   sortColumn: 'created_at',\r\n   *   sortOrder: 'desc',\r\n   *   search: 'analytics'\r\n   * })\r\n   * if (data) {\r\n   *   console.log('Found analytics buckets:', data.length)\r\n   *   data.forEach(bucket => console.log(`- ${bucket.name}`))\r\n   * }\r\n   * ```\r\n   */\r\n  async listBuckets(options?: {\r\n    limit?: number\r\n    offset?: number\r\n    sortColumn?: 'id' | 'name' | 'created_at' | 'updated_at'\r\n    sortOrder?: 'asc' | 'desc'\r\n    search?: string\r\n  }): Promise<\r\n    | {\r\n        data: AnalyticBucket[]\r\n        error: null\r\n      }\r\n    | {\r\n        data: null\r\n        error: StorageError\r\n      }\r\n  > {\r\n    try {\r\n      // Build query string from options\r\n      const queryParams = new URLSearchParams()\r\n      if (options?.limit !== undefined) queryParams.set('limit', options.limit.toString())\r\n      if (options?.offset !== undefined) queryParams.set('offset', options.offset.toString())\r\n      if (options?.sortColumn) queryParams.set('sortColumn', options.sortColumn)\r\n      if (options?.sortOrder) queryParams.set('sortOrder', options.sortOrder)\r\n      if (options?.search) queryParams.set('search', options.search)\r\n\r\n      const queryString = queryParams.toString()\r\n      const url = queryString ? `${this.url}/bucket?${queryString}` : `${this.url}/bucket`\r\n\r\n      const data = await get(this.fetch, url, { headers: this.headers })\r\n      // Filter to only return analytics buckets\r\n      const analyticsBuckets = Array.isArray(data)\r\n        ? data.filter((bucket: Bucket) => bucket.type === 'ANALYTICS')\r\n        : []\r\n      return { data: analyticsBuckets, error: null }\r\n    } catch (error) {\r\n      if (this.shouldThrowOnError) {\r\n        throw error\r\n      }\r\n      if (isStorageError(error)) {\r\n        return { data: null, error }\r\n      }\r\n\r\n      throw error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Deletes an existing analytics bucket\r\n   * A bucket can't be deleted with existing objects inside it\r\n   * You must first empty the bucket before deletion\r\n   *\r\n   * @param bucketId The unique identifier of the bucket you would like to delete\r\n   * @returns Promise with success message or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await analyticsApi.deleteBucket('old-analytics-bucket')\r\n   * if (error) {\r\n   *   console.error('Failed to delete bucket:', error.message)\r\n   * } else {\r\n   *   console.log('Bucket deleted successfully:', data.message)\r\n   * }\r\n   * ```\r\n   */\r\n  async deleteBucket(bucketId: string): Promise<\r\n    | {\r\n        data: { message: string }\r\n        error: null\r\n      }\r\n    | {\r\n        data: null\r\n        error: StorageError\r\n      }\r\n  > {\r\n    try {\r\n      const data = await remove(\r\n        this.fetch,\r\n        `${this.url}/bucket/${bucketId}`,\r\n        {},\r\n        { headers: this.headers }\r\n      )\r\n      return { data, error: null }\r\n    } catch (error) {\r\n      if (this.shouldThrowOnError) {\r\n        throw error\r\n      }\r\n      if (isStorageError(error)) {\r\n        return { data: null, error }\r\n      }\r\n\r\n      throw error\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}